var VueFunnelGraph=function(t,e,n,a,s,i){"use strict";!function(t,e){void 0===e&&(e={});var n=e.insertAt;if(t&&"undefined"!=typeof document){var a=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css","top"===n&&a.firstChild?a.insertBefore(s,a.firstChild):a.appendChild(s),s.styleSheet?s.styleSheet.cssText=t:s.appendChild(document.createTextNode(t))}}(".appear-enter-active, .appear-leave-active {\n  transition: all 0.7s ease-in-out;\n}\n\n.appear-enter-to, .appear-leave {\n  max-width: 100%;\n  max-height: 100%;\n  opacity: 1;\n}\n\n.appear-enter, .appear-leave-to {\n  max-width: 0;\n  max-height: 0;\n  opacity: 0;\n}\n\n.fade-enter-active, .fade-leave-active {\n  transition: all 0.3s ease;\n}\n\n.fade-enter-to, .fade-leave {\n  opacity: 1;\n}\n\n.fade-enter, .fade-leave-to {\n  opacity: 0;\n}");var r={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"funnel svg-funnel-js",class:{"svg-funnel-js--vertical":"vertical"===t.direction}},[n("div",{staticClass:"svg-funnel-js__container"},[n("svg",{attrs:{width:t.width,height:t.height}},[n("defs",t._l(t.gradientSet,(function(e,a){return n("linearGradient",{key:a,attrs:{id:"funnelGradient-"+(a+1),gradientTransform:t.gradientAngle}},t._l(e.values,(function(a,s){return n("stop",{key:s,attrs:{"stop-color":a,offset:t.offsetColor(s,e.values.length)}})})),1)})),1),t._v(" "),t._l(t.paths,(function(e,a){return n("path",{key:a,attrs:{fill:t.colorSet[a].fill,stroke:t.colorSet[a].fill,d:e}})}))],2)]),t._v(" "),n("transition-group",{staticClass:"svg-funnel-js__labels",attrs:{name:"appear",tag:"div"},on:{enter:t.enterTransition,leave:t.leaveTransition}},t._l(t.valuesFormatted,(function(e,a){return n("div",{key:t.labels[a].toLowerCase().split(" ").join("-"),staticClass:"svg-funnel-js__label",class:"label-"+(a+1)},[n("div",{staticClass:"label__value"},[t._v(t._s(e))]),t._v(" "),t.labels?n("div",{staticClass:"label__title"},[t._v(t._s(t.labels[a]))]):t._e(),t._v(" "),t.displayPercentage&&100!==t.percentages()[a]?n("div",{staticClass:"label__percentage"},[t._v("\n                "+t._s(t.percentages()[a])+"%\n            ")]):t._e(),t._v(" "),t.is2d()?n("div",{staticClass:"label__segment-percentages"},[n("ul",{staticClass:"segment-percentage__list"},t._l(t.subLabels,(function(e,s){return n("li",{key:s},[t._v("\n                        "+t._s(e)+":\n                        "),"percent"===t.subLabelValue?n("span",{staticClass:"percentage__list-label"},[t._v(t._s(t.twoDimPercentages()[a][s])+"%")]):n("span",{staticClass:"percentage__list-label"},[t._v(t._s(t._f("format")(t.values[a][s])))])])})),0)]):t._e()])})),0),t._v(" "),n("transition",{attrs:{name:"fade"},on:{enter:t.enterTransition,leave:t.leaveTransition}},[t.is2d()?n("div",{staticClass:"svg-funnel-js__subLabels"},t._l(t.subLabels,(function(e,a){return n("div",{key:a,class:"svg-funnel-js__subLabel svg-funnel-js__subLabel-"+(a+1)},[n("div",{staticClass:"svg-funnel-js__subLabel--color",style:t.subLabelBackgrounds(a)}),t._v(" "),n("div",{staticClass:"svg-funnel-js__subLabel--title"},[t._v(t._s(e))])])})),0):t._e()])],1)},staticRenderFns:[],name:"VueFunnelGraph",props:{animated:{type:Boolean,default:!1},width:[String,Number],height:[String,Number],values:Array,labels:Array,colors:{type:Array,default:function(){return[]}},subLabels:Array,subLabelValue:{type:String,default:"percent"},direction:{type:String,default:"horizontal"},gradientDirection:{type:String,default:"horizontal"},displayPercentage:{type:Boolean,default:!0}},data:function(){return{paths:[],prevPaths:[],graph:null,tween:null,defaultColors:i.getDefaultColors(10)}},computed:{valuesFormatted:function(){return this.graph.is2d()?this.graph.getValues2d().map((function(t){return s.formatNumber(t)})):this.values.map((function(t){return s.formatNumber(t)}))},colorSet:function(){for(var t=[],e=0,n=0;n<this.paths.length;n++){var a=this.graph.is2d()?this.getColors[n]:this.getColors,s="string"==typeof a||1===a.length?"solid":"gradient";"gradient"===s&&(e+=1),t.push({values:a,fillMode:s,fill:"solid"===s?a:"url('#funnelGradient-"+e+"')"})}return t},gradientSet:function(){var t=[];return this.colorSet.forEach((function(e){"gradient"===e.fillMode&&t.push(e)})),t},getColors:function(){return this.colors instanceof Array&&0===this.colors.length?i.getDefaultColors(this.is2d()?this.values[0].length:2):this.colors.length<this.paths.length?[].concat(this.colors).concat([].concat(this.defaultColors).splice(this.paths.length,this.paths.length-this.colors.length)):this.colors},gradientAngle:function(){return"rotate("+("vertical"===this.gradientDirection?90:0)+")"}},methods:{enterTransition:function(t,e){this.animated||e(),setTimeout((function(){return e()}),700)},leaveTransition:function(t,e){this.animated||e(),setTimeout((function(){return e()}),700)},is2d:function(){return this.graph.is2d()},percentages:function(){return this.graph.createPercentages()},twoDimPercentages:function(){return this.is2d()?this.graph.getPercentages2d():[]},subLabelBackgrounds:function(t){return this.is2d()?i.generateLegendBackground(this.getColors[t],this.gradientDirection):[]},offsetColor:function(t,e){return Math.round(100*t/(e-1))+"%"},makeAnimations:function(){var t=this;null!==this.tween&&this.tween.stop();var a=[],s=this.prevPaths.length!==this.paths.length,i={x:.5,y:.5};s&&(i={x:0,y:.5},this.graph.isVertical()&&(i={x:1,y:1}),this.graph.is2d()||(i={x:0,y:1})),this.paths.forEach((function(n,r){var l=t.prevPaths[r]||t.graph.getPathMedian(r);s&&(l=t.graph.getPathMedian(r));var o=e.interpolate([l,n],{addPoints:1,origin:i,optimize:"fill",precision:1});a.push(o)}));var r={value:0};this.tween=new n.Tween(r).to({value:1},700).easing(n.Easing.Cubic.InOut).onUpdate((function(){for(var e=0;e<t.paths.length;e++)t.$set(t.paths,e,a[e](r.value))})),this.tween.start(),function t(){n.update()&&requestAnimationFrame(t)}()},drawPaths:function(){var t=this;this.prevPaths=this.paths,this.paths=[],this.graph.getPathDefinitions().forEach((function(e){t.paths.push(e)}))}},created:function(){this.graph=new a({height:this.height,width:this.width,direction:this.direction,data:{labels:this.labels,values:this.values}}),this.drawPaths(),this.animated&&this.makeAnimations()},watch:{values:function(){this.graph.setValues(this.values),this.drawPaths(),this.animated&&this.makeAnimations()},direction:function(){this.graph.setDirection(this.direction).setWidth(this.width).setHeight(this.height),this.drawPaths()}},filters:{format:function(t){return s.formatNumber(t)}}},l=Object.freeze({__proto__:null,VueFunnelGraph:r});var o={install:function t(e){t.installed||(t.installed=!0,Object.keys(l).forEach((function(t){e.component(t,l[t])})))}},u=null;return"undefined"!=typeof window?u=window.Vue:"undefined"!=typeof global&&(u=global.Vue),u&&u.use(o),t.VueFunnelGraph=r,t.default=o,Object.defineProperty(t,"__esModule",{value:!0}),t}({},interpolate,TWEEN,FunnelGraph,formatNumber,getDefaultColors);
